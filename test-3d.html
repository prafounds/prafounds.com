<!DOCTYPE html>
<html>
<head>
    <title>3D Test</title>
    <style>
        body { margin: 0; background: #030304; }
        #info {
            position: absolute;
            top: 10px;
            left: 10px;
            color: white;
            font-family: monospace;
            background: rgba(0,0,0,0.7);
            padding: 10px;
            z-index: 1000;
        }
        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            z-index: 1;
        }
    </style>
</head>
<body>
    <div id="info">
        <div>Status: <span id="status">Checking...</span></div>
        <div>THREE.js: <span id="three-status">Loading...</span></div>
        <div>Canvas: <span id="canvas-status">Checking...</span></div>
    </div>
    <div id="canvas-container"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
    <script>
        console.log('Script started');

        function updateStatus(id, text, color) {
            const el = document.getElementById(id);
            if (el) {
                el.textContent = text;
                el.style.color = color || 'white';
            }
        }

        window.addEventListener('load', function() {
            console.log('Window loaded');

            // Check THREE.js
            if (typeof THREE === 'undefined') {
                console.error('THREE.js not loaded!');
                updateStatus('three-status', 'NOT LOADED', 'red');
                updateStatus('status', 'FAILED - THREE.js missing', 'red');
                return;
            }

            console.log('THREE.js version:', THREE.REVISION);
            updateStatus('three-status', 'Loaded v' + THREE.REVISION, 'lime');

            // Check canvas container
            const container = document.getElementById('canvas-container');
            if (!container) {
                console.error('Canvas container not found!');
                updateStatus('canvas-status', 'NOT FOUND', 'red');
                updateStatus('status', 'FAILED - No container', 'red');
                return;
            }

            updateStatus('canvas-status', 'Found', 'lime');
            console.log('Canvas container found');

            try {
                // Create scene
                const scene = new THREE.Scene();
                scene.fog = new THREE.FogExp2(0x030304, 0.0015);
                console.log('Scene created');

                // Create camera
                const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
                camera.position.z = 50;
                console.log('Camera created');

                // Create renderer
                const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
                renderer.setSize(window.innerWidth, window.innerHeight);
                container.appendChild(renderer.domElement);
                console.log('Renderer created and appended');

                // Create a simple test sphere
                const geometry = new THREE.SphereGeometry(5, 32, 32);
                const material = new THREE.MeshBasicMaterial({
                    color: 0x22D3EE,
                    wireframe: true
                });
                const sphere = new THREE.Mesh(geometry, material);
                scene.add(sphere);
                console.log('Test sphere added');

                // Create network nodes
                const nodes = [];
                for (let i = 0; i < 30; i++) {
                    const nodeGeo = new THREE.SphereGeometry(0.3, 8, 8);
                    const nodeMat = new THREE.MeshBasicMaterial({ color: 0x22D3EE });
                    const node = new THREE.Mesh(nodeGeo, nodeMat);

                    node.position.x = (Math.random() - 0.5) * 50;
                    node.position.y = (Math.random() - 0.5) * 50;
                    node.position.z = (Math.random() - 0.5) * 50;

                    nodes.push(node);
                    scene.add(node);
                }
                console.log('Created', nodes.length, 'nodes');

                updateStatus('status', 'RUNNING - ' + nodes.length + ' nodes', 'lime');

                // Animation loop
                function animate() {
                    requestAnimationFrame(animate);

                    sphere.rotation.x += 0.01;
                    sphere.rotation.y += 0.01;

                    nodes.forEach((node, i) => {
                        node.rotation.x += 0.01;
                        node.position.x += Math.sin(Date.now() * 0.001 + i) * 0.01;
                        node.position.y += Math.cos(Date.now() * 0.001 + i) * 0.01;
                    });

                    renderer.render(scene, camera);
                }

                animate();
                console.log('Animation started');

                // Handle resize
                window.addEventListener('resize', function() {
                    camera.aspect = window.innerWidth / window.innerHeight;
                    camera.updateProjectionMatrix();
                    renderer.setSize(window.innerWidth, window.innerHeight);
                });

            } catch (error) {
                console.error('Error creating 3D scene:', error);
                updateStatus('status', 'ERROR: ' + error.message, 'red');
            }
        });
    </script>
</body>
</html>
